<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Th·ªùi kh√≥a bi·ªÉu ‚Äî chuy√™n nghi·ªáp</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="app" aria-label="·ª®ng d·ª•ng th·ªùi kh√≥a bi·ªÉu">
      <header class="bar" role="banner">
        <div class="brand">
          <div class="logo" aria-hidden="true">üìö</div>

          <!-- N√öT TI√äU ƒê·ªÄ: b·∫•m ƒë·ªÉ g√µ tr·ª±c ti·∫øp -->
          <button
            id="titleBtn"
            class="title title-btn"
            aria-label="ƒê·ªïi ti√™u ƒë·ªÅ"
          >
            <span id="titleText"></span>
          </button>
        </div>
        <div class="actions">
          <span class="hint hint--bar">
            G√µ <b><u>Shift/ Cmd </u></b> + <b><u>Delete</u></b> xo√° s·∫°ch ti√™u ƒë·ªÅ
          </span>
          <button
            id="themeBtn"
            class="btn"
            title="Chuy·ªÉn giao di·ªán s√°ng/t·ªëi"
            aria-pressed="false"
          >
            üåì Giao di·ªán
          </button>
          <button id="printBtn" class="btn" title="In ho·∫∑c l∆∞u PDF (A4 ngang)">
            üñ®Ô∏è In / PDF
          </button>
        </div>
      </header>

      <nav class="controls" aria-label="ƒêi·ªÅu khi·ªÉn">
        <div class="button-group-center">
          <button
            id="createBtn"
            style="font-family: Georgia, 'Times New Roman', Times, serif"
            class="btn primary"
          >
            üß© T·∫°o b·∫£ng
          </button>
          <button id="addRowAmBtn" class="btn">‚ûï H√†ng s√°ng</button>
          <button id="delRowAmBtn" class="btn danger">‚ûñ Xo√° h√†ng s√°ng</button>
          <button id="undoBtn" class="btn" title="Ho√†n t√°c (Ctrl+Z)">
            ‚Ü©Ô∏è Ho√†n t√°c
          </button>
          <button id="redoBtn" class="btn" title="L√†m l·∫°i (Ctrl+Shift+Z)">
            ‚Ü™Ô∏è Tr·ªü l·∫°i
          </button>
          <button
            id="restoreBtn"
            class="btn"
            title="Kh√¥i ph·ª•c t·ª´ b·∫£n l∆∞u t·ª± ƒë·ªông"
          >
            üîÑ L·ªãch s·ª≠ thao t√°c
          </button>
          <button
            id="clearBtn"
            class="btn danger"
            title="Xo√° h·∫øt d·ªØ li·ªáu trong b·∫£ng hi·ªán t·∫°i"
          >
            Xo√° s·∫°ch d·ªØ li·ªáu
          </button>

          <!-- INPUT ·∫®N & N√öT IMPORT -->
          <input type="file" id="importFile" style="display: none" />
          <button id="importBtn" class="btn">üìÇ Import file</button>
        </div>

        <select id="vaultSelect" class="btn">
          <option value="">‚Äî Ch·ªçn b·∫£ng ƒë√£ l∆∞u ‚Äî</option>
        </select>
        <button id="openVaultBtn" class="btn">üìÇ M·ªü</button>
        <button id="deleteVaultBtn" class="btn danger">üóëÔ∏è Xo√° l∆∞u</button>

        <!-- Xu·∫•t -->
        <button id="exportDocBtn" class="btn" title="Xu·∫•t Word (gi·ªØ k·∫ª b·∫£ng)">
          <img
            src="word-icon-24.png"
            alt="Word"
            style="
              height: 20px;
              width: 20px;
              vertical-align: middle;
              margin-right: 6px;
            "
          />
          Xu·∫•t Word
        </button>
        <button
          id="exportXlsBtn"
          class="btn"
          title="Xu·∫•t Excel (.xls, gi·ªØ k·∫ª √¥)"
        >
          <img
            src="excel-icon-24.png"
            alt="Excel"
            style="
              height: 20px;
              width: 20px;
              vertical-align: middle;
              margin-right: 6px;
            "
          />
          Xu·∫•t Excel
        </button>

        <button
          id="purgeHistoryBtn"
          class="btn danger"
          aria-label="Xo√° l·ªãch s·ª≠"
        >
          ‚å´ L·ªãch s·ª≠ thao t√°c
        </button>
        <span class="hint hint--bar"
          >Xo√° d·ªØ li·ªáu √¥ (Delete); copy √¥ (Ctrl + C)</span
        >
      </nav>

      <main class="table-wrap" role="main">
        <table id="tkb" aria-label="B·∫£ng th·ªùi kh√≥a bi·ªÉu">
          <thead id="thead"></thead>
          <tbody id="tbody"></tbody>
        </table>
      </main>

      <footer class="foot">
        <div id="status" class="status" role="status" aria-live="polite">
          S·∫µn s√†ng ‚ú®
        </div>
        <div class="toolbar">
          <button id="addRowPmBtn" class="btn">‚ûï H√†ng chi·ªÅu</button>
          <button id="delRowPmBtn" class="btn danger">‚ûñ Xo√° h√†ng chi·ªÅu</button>
        </div>

        <div class="hint-row">
          <span class="hint hint--bar">
            G√µ <b><u>Enter</u></b> xu·ªëng d√≤ng. G√µ <b><u>Tab</u></b> di chuy·ªÉn
            sang ph·∫£i. Mu·ªën ch√®n h√†ng tr√™n, gi·ªØ ph√≠m <b><u>Shift</u></b> +
            <b><u>H√†ng s√°ng/chi·ªÅu</u></b
            >. Tho√°t kh·ªèi ch·∫ø ƒë·ªô ch·ªçn √¥, b·∫•m n√∫t
            <b><u>ESC/ nh·∫•n ra b√™n ngo√†i b·∫£ng </u></b>
          </span>
        </div>
      </footer>
    </div>

    <!-- Modal t·∫°o b·∫£ng (gi·ªØ nguy√™n h·ªá th·ªëng modal s·∫µn c√≥ c·ªßa b·∫°n) -->
    <div
      id="createModal"
      class="modal modal--alert"
      aria-hidden="true"
      role="dialog"
      aria-labelledby="createModalTitle"
    >
      <div class="modal__overlay" data-close></div>
      <div class="modal__panel" role="document">
        <div class="modal__header">
          <h3 id="createModalTitle" class="modal__title">T·∫°o b·∫£ng</h3>
          <button
            class="modal__close"
            type="button"
            aria-label="ƒê√≥ng"
            data-close
          >
            ‚úï
          </button>
        </div>
        <p class="modal__desc">Ch·ªçn ch·ª©c nƒÉng b·∫°n mu·ªën:</p>
        <div class="modal__actions">
          <button id="optRestoreBtn" class="btn btn--glass" autofocus>
            <span class="btn__icon">üóÇÔ∏è</span
            ><span class="btn__text">L·∫•y l·∫°i gi√° tr·ªã b·∫£ng c≈©</span
            ><span class="btn__glow"></span>
          </button>
          <button id="optClearBtn" class="btn btn--danger-glass">
            <span class="btn__icon">üßπ</span
            ><span class="btn__text">Xo√° h·∫øt d·ªØ li·ªáu b·∫£ng c≈©</span
            ><span class="btn__glow"></span>
          </button>
        </div>
      </div>
    </div>

    <!-- ===== IMPORT MODAL (m·ªõi) ===== -->
    <div id="imod-overlay" class="imod-overlay" hidden></div>
    <div
      id="imod-card"
      class="imod-card"
      role="dialog"
      aria-modal="true"
      aria-labelledby="imod-title"
      hidden
    >
      <div class="imod-header">
        <h3 id="imod-title">Import file</h3>
        <button id="imod-close" class="imod-close" aria-label="ƒê√≥ng">√ó</button>
      </div>
      <p class="imod-sub">Ch·ªçn ƒë·ªãnh d·∫°ng b·∫°n mu·ªën:</p>
      <div class="imod-actions">
        <!-- PDF (Adobe) -->
        <button
          class="imod-btn imod-btn--pdf"
          data-kind="pdf"
          aria-label="Import PDF"
        >
          <span class="imod-icon" aria-hidden="true">
            <!-- Adobe-style ribbon A -->
            <svg viewBox="0 0 24 24" width="22" height="22" fill="none">
              <rect x="2" y="2" width="20" height="20" rx="3" fill="#FFFFFF" />
              <path
                d="M6.4 17.5c2.3-4.3 4.2-7.7 7-11.8c.2-.3.7-.3.9 0c.4.6.6 1.1.7 1.7c.1.4-.2.8-.6.9c-1.1.2-2 .5-2.8.9c1.5 2.6 3.3 4.7 5.5 6.4c.4.3.4.9-.1 1.1c-.8.4-1.7.7-2.7.8c-.4.1-.8-.2-.9-.6c-.3-1.1-.8-2.2-1.3-3.2c-1.5.6-3.2 1-5 .9c-.4 0-.7.2-.8.6c-.1.7-.2 1.4-.3 2.1c0 .4-.4.7-.8.7H6.4z"
                fill="#FA0F00"
              />
            </svg>
          </span>
          <span class="imod-text">
            <strong>Import PDF</strong>
            <small>.pdf</small>
          </span>
        </button>

        <!-- Word (Microsoft Fluent) -->
        <button
          class="imod-btn imod-btn--word"
          data-kind="word"
          aria-label="Import Word"
        >
          <span class="imod-icon" aria-hidden="true">
            <svg viewBox="0 0 48 48" width="22" height="22" fill="none">
              <rect x="14" y="6" width="28" height="36" rx="3" fill="#2B579A" />
              <rect x="6" y="12" width="16" height="24" rx="2" fill="#185ABD" />
              <path
                d="M12 18l3.2 12h2.6l2-7.6 2 7.6h2.6L28 18h-2.6l-1.7 7-1.8-7h-2.2l-1.8 7L16.2 18H12z"
                fill="#FFFFFF"
              />
            </svg>
          </span>
          <span class="imod-text">
            <strong>Import Word</strong>
            <small>.doc/.docx</small>
          </span>
        </button>

        <!-- Excel (Microsoft Fluent) -->
        <button
          class="imod-btn imod-btn--excel"
          data-kind="excel"
          aria-label="Import Excel"
        >
          <span class="imod-icon" aria-hidden="true">
            <svg viewBox="0 0 48 48" width="22" height="22" fill="none">
              <rect x="14" y="6" width="28" height="36" rx="3" fill="#107C41" />
              <rect x="6" y="12" width="16" height="24" rx="2" fill="#0E7A3E" />
              <path
                d="M12.5 19l4.1 5.9L12.5 31h3l2.6-3.9L20.7 31h3l-4-6 4-6h-3l-2.6 3.9L15.6 19h-3.1z"
                fill="#FFFFFF"
              />
            </svg>
          </span>
          <span class="imod-text">
            <strong>Import Excel</strong>
            <small>.xls/.xlsx/.csv</small>
          </span>
        </button>
      </div>
    </div>

    <!-- Th∆∞ vi·ªán c·∫ßn thi·∫øt -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <!-- ƒê∆∞a Mammoth TR∆Ø·ªöC app.js ƒë·ªÉ ch·∫Øc ch·∫Øn s·∫µn s√†ng khi g·ªçi -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.5.1/mammoth.browser.min.js"></script>
    <script>
      window.API_URL =
        "https://script.google.com/macros/s/AKfycbxwTfNX39wC26fw5imA8v6RXiF6RsZtGRxx3TZS5fv0pJwsQpOQQEoJZYxRTd9G0yGxkA/exec";
      window.API_SECRET = "chuoi-bi-mat_cua_ban";
    </script>
    <script src="app.js"></script>
  </body>
</html>
